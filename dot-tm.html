<!doctype html>
<html lang="en">
<head>
    <title>Dot-tm</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="dot-tm.js"></script>
</head>

<body onload="newTM()">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://pbx-group-security.com/js/graph/vis.js"></script>

    <header>
        <!-- Fixed navbar -->
        <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
            <a class="navbar-brand" href="#">Dot-TM</a>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <input class="btn btn-link" id="btnNew" value="New TM" type="button" onclick="newTM()" />
                        <input class="btn btn-link" id="btnExample" value="Load Example" type="button" onclick="loadExample()" />
                        <input id="btnUpload" class="btn btn-outline-secondary" value="Upload Json" type="file" onchange="uploadJson()" />
                        <input class="btn btn-link" id="btnGetJson" value="Get JSON" type="button" onclick="getJSON()" />
                        <input class="btn btn-link" id="btnGetGraph" value="Generate Graph" type="button" onclick="loadGraph()" />
                        <div class="form-check">
                            <input class="form-check-input" id="switchGraph" type="checkbox" value="false" onchange="switchGraph()">
                            <label class="form-check-label text-light">
                                Interactive graph (Experimental)
                            </label>
                        </div>
                        <!--<label class="form-control"><input  id="switchGraph" type="checkbox" onchange="switchGraph()" />Interactive graph (Experimental)</label> -->
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <main role="main" class="container">

        <br />
        <br />

        <div id="content">
        </div>

        <div id="fileContents"></div>

        <div id="TM" class="mt-5">
        </div>

        <div style="width: 50%" id="graph"></div>
        <div style="width: 50%" hidden id="interactivegraph"></div>




        <div>
            <h2 class="mt-5">Doomsdays </h2>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Category</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="doomCategory">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Description</label>
                <div class="col-sm-10">
                    <textarea class="form-control" id="doomLabel"></textarea>
                </div>
            </div>
            <div class="form-group row">
                <input class="btn btn-primary mb-2" id="btndoomsday" type="button" value="Add Doomsday" onclick="addDoomsday()" />
            </div>
            <div class="form-group row">
                <div id="Doomsdays">
                </div>
            </div>
        </div>
        <div>
            <br />
            <h2 class="mt-5">List of Entities</h2>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Label</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="entityLabel">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Cluster</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="entityCluster">
                </div>
            </div>
            <div class="form-group row">
                <input class="btn btn-primary mb-2" id="btnentity" type="button" value="Add Entity" onclick="addEntity()" />
            </div>
            <div class="form-group row">
                <div id="Entities">
                </div>
            </div>
        </div>
        <div>
            <br />
            <h2 class="mt-5">List of Processes</h2>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Label</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="processLabel">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Cluster</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="processCluster">
                </div>
            </div>
            <div class="form-group row">
                <input class="btn btn-primary mb-2" id="btnprocess" type="button" value="Add Process" onclick="addProcess()" />
            </div>
            <div class="form-group row">
                <div id="Processes">
                </div>
            </div>
        </div>
        <div>
            <br />
            <h2 class="mt-5">List of Datastores</h2>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Label</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="datastoreLabel">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Cluster</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="datastoreCluster">
                </div>
            </div>
            <div class="form-group row">
                <input class="btn btn-primary mb-2" id="btndatastore" type="button" value="Add Datastore" onclick="addDatastore()" />
            </div>
            <div class="form-group row">
                <div id="Datastores">
                </div>
            </div>
        </div>


        <div>
            <br />
            <h2 class="mt-5">Nested Clusters</h2>
            <div class="form-row align-items-center">
                <div class="col-auto">
                    Declared clusters :
                </div>
                <div class="col-auto">
                    <div id="clusterList">
                    </div>
                </div>
            </div>

            <br />
            Clusters group object with each other. They can also be nested. Use the clusters from the declared list. Each cluster needs to be coma separated. Respect the following order : left cluster is the most outside, right cluster is the most nested
    <br />

            <div class="form-row align-items-center">
                <div class="col-auto">
                    NestedCluster :
                </div>
                <div class="col-auto">
                    <input type="text" class="form-control mb-2" id="nestedCluster">
                </div>
                <div class="col-auto">
                    <input class="btn btn-primary mb-2" id="btncluster" type="button" value="Add cluster" onclick="addCluster()" />
                </div>

            </div>

            <div id="Clusters">
            </div>
        </div>

        <div>

            <br />
            <h2 class="mt-5">List of Edges</h2>
            <div class="form-row align-items-center">
                <div class="col-auto">
                    <input id="edgeID" hidden type="text" />
                    From :
    <select id="edgeFrom">
    </select>
                </div>
                <div class="col-auto">
                    To: 
    <select id="edgeTo">
    </select>
                </div>
                <div class="col-auto">
                    Label :
                    <input id="edgeLabel" type="text" />
                </div>
                <div class="col-auto">
                    isTrustBoundary? :
                    <input id="isTrustBoundary" type="checkbox" value="false" onchange="displayStride()" />
                </div>
            </div>
            <div id="tmlabel">Trust boundary label :<input id="crossingboundary" type="text" /></div>


            <table id="strideTable" class="table table-striped">
                <tr>
                    <td></td>
                    <td>From Threat</td>
                    <td>From Mitigation</td>
                    <td>Dataflow Threat</td>
                    <td>Dataflow Mitigation</td>
                    <td>To Threat</td>
                    <td>To Mitigation</td>

                </tr>
                <tr>
                    <td>Spoofing</td>
                    <td>
                         <textarea id="st1"></textarea></td>
                    <td>
                        <textarea id="sm1" ></textarea>></td>
                    <td>
                        <textarea id="st2" ></textarea></td>
                    <td>
                        <textarea id="sm2" ></textarea></td>
                    <td>
                        <textarea id="st3" ></textarea></td>
                    <td>
                        <textarea id="sm3" ></textarea></td>

                </tr>
                <tr>
                    <td>Tampering</td>
                    <td>
                        <textarea id="tt1" ></textarea></td>
                    <td>
                        <textarea id="tm1" ></textarea></td>
                    <td>
                        <textarea id="tt2" ></textarea></td>
                    <td>
                        <textarea id="tm2" ></textarea></td>
                    <td>
                        <textarea id="tt3" ></textarea></td>
                    <td>
                        <textarea id="tm3" ></textarea></td>
                </tr>
                <tr>
                    <td>Repudiation</td>
                    <td>
                        <textarea id="rt1" ></textarea></td>
                    <td>
                        <textarea id="rm1" ></textarea></td>
                    <td>
                        <textarea id="rt2" ></textarea></td>
                    <td>
                        <textarea id="rm2" ></textarea></td>
                    <td>
                        <textarea id="rt3" ></textarea></td>
                    <td>
                        <textarea id="rm3" ></textarea></td>
                </tr>
                <tr>
                    <td>Information Disclosure</td>
                    <td>
                        <textarea id="it1" ></textarea></td>
                    <td>
                        <textarea id="im1" ></textarea></td>
                    <td>
                        <textarea id="it2" ></textarea></td>
                    <td>
                        <textarea id="im2" ></textarea></td>
                    <td>
                        <textarea id="it3" ></textarea></td>
                    <td>
                        <textarea id="im3" ></textarea></td>
                </tr>
                <tr>
                    <td>Denial of Service</td>
                    <td>
                        <textarea id="dt1" ></textarea></td>
                    <td>
                        <textarea id="dm1" ></textarea></td>
                    <td>
                        <textarea id="dt2" ></textarea></td>
                    <td>
                        <textarea id="dm2" ></textarea></td>
                    <td>
                        <textarea id="dt3" ></textarea></td>
                    <td>
                        <textarea id="dm3" ></textarea></td>
                </tr>
                <tr>
                    <td>Elevation of Privilege</td>
                    <td>
                        <textarea id="et1" ></textarea></td>
                    <td>
                        <textarea id="em1" ></textarea></td>
                    <td>
                        <textarea id="et2" ></textarea></td>
                    <td>
                        <textarea id="em2" ></textarea></td>
                    <td>
                        <textarea id="et3" ></textarea></td>
                    <td>
                        <textarea id="em3" ></textarea></td>
                </tr>
            </table>
            <br />
            <input class="btn btn-primary mb-2" id="btnedge" type="button" value="Add Edge" onclick="addEdge()" />
            <div id="Edges">
            </div>
        </div>


    </main>

</body>


</html>
